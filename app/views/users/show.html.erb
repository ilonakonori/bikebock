<div class="my-card" id='user' data-online-id="<%= @user.id %>">
  <div class="my-row" style="display: flex; justify-content: space-around; padding-bottom: 16px;">
    <%= cl_image_tag @user.profile_photo.key, height: 127, width: 127, crop: :fill, style: "margin-top: 16px; border-radius: 50%; box-shadow: 3px 4px 5px 0px rgba(0, 0, 0, 0.38);" %>
    <div class="my-card-body" style="padding: 0 16px;">
      <h6 style="font-size: 4vw;"><%= @user.name %></h6>
      <!-- render part -->
      <div id='online-<%= @user.id %>'>
        <p id='user' data-online-id="<%= @user.id %>" style="font-size: 11px; font-weight: 300; margin-bottom: 0 !important;">
          Online
          <%
            if @user.online?
              present_color = '#00917C;'
            else
              present_color = '#aaa;'
            end
          %>
          <span>
            <i class='fas fa-circle' style="color: <%= present_color %>"></i>
          </span>
          <% if !@user.online? %>
            <span style="font-size: 11px;"> <%= @user.last_online %></span>
          <% end %>
        </p>
      </div>
      <!-- end of render part -->
      <hr style="width: 95%; text-align: left; margin-left: 0;">
      <p style="font-size: 3vw;"><%= @user.about_me %></p>
    </div>
  </div>
</div>

<div style='max-height: 66vh; overflow-y: scroll;'>
  <div class="card" style="border:none;">
    <%= cl_image_tag @user.bike_photo.key, class: "d-block w-100", style: "border-radius: 16px; height: 45vw;"%>
  </div>

  <div class="my-container" style="padding: 20px 0;">
    <div style="display: flex; flex-wrap: wrap;">
      <% @user.tags.each do |tag| %>
        <p class="interests"><%= link_to tag.name, tag_path(tag) %></p>
      <% end %>
    </div>
  </div>

  <div>
    <% if @user.rides.empty? %>
      <p class="text-secondary"> Still don't have any bike rides</p>
    <% else %>
      <% @user.rides.each do |ride| %>
        <%= link_to ride_path(ride) do %>
          <div class="card rides" >
          <div style="display: flex; justify-content: flex-end; align-items: center; padding: 8px 8px;">
            <%= cl_image_tag ride.user.profile_photo.key, height: 40, width: 40, crop: :fill, style: "border-radius: 50%; box-shadow: 3px 4px 5px 0px rgba(0, 0, 0, 0.38);" %>
          </div>
            <%= cl_image_tag ride.photos.second.key, style: "border-radius: 16px; height: 40vw;"%>
          <br>
            <div style="display: flex; justify-content: start;">
              <h5 style="font-size: 4vw; padding-left: 4px; padding-right: 4px; color: #333333;"><%= ride.title %></h5>
              <p style="display: flex; justify-content: flex-end; color: #00917C; padding-left: 4px; font-size: 12px;">
              <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i></p>
            </div>
            <p style="font-size: 3vw; padding-left: 4px;"><%= ride.short_description[0..200] %>...</p>
          </div>
        <% end %>
      <% end %>
    <% end %>
    <div style="padding-top: 32px;">
      <% if @user == current_user %>
        <%= link_to "Edit Profile", edit_user_registration_path(@user), style: "background-color: #433520; padding: 8px 55px; margin-left: 60px; box-shadow: 3px 4px 5px 0px rgba(0, 0, 0, 0.38); border-radius: 16px; color: #fff; font-weight: 400;" %>

        <!-- not in profile!
        <#%= link_to "My Messages", conversations_path %>
        <#%= link_to "Add Ride", new_ride_path, class: "" %>
        <#%= link_to "Edit Profile", edit_user_registration_path(@user) %>
        end -->
<!--
      <#% elsif Request.where(accepted: false, sender_id: current_user, recipient_id: @user).present? %>
        <#% request = Request.where(accepted: false, sender_id: current_user, recipient_id: @user).first %>
        <#%= link_to 'Request already sent, status: pending', request_path(request.id) %>
      <#% elsif Request.where(accepted: false, sender_id: @user, recipient_id: current_user).present? %>
        <#% request = Request.where(accepted: false, sender_id: @user, recipient_id: current_user).first %>
        <#%= link_to 'Check your request', request_path(request.id) %>
      <#% elsif Conversation.where(sender_id: current_user, recipient_id: @user).present? || Conversation.where(sender_id: @user, recipient_id: current_user).present? %>
        <#% room = Conversation.where(sender_id: current_user, recipient_id: @user).or(Conversation.where(sender_id: @user, recipient_id: current_user)).first %>
        <#%= link_to 'Send Messege', conversation_path(room.id, anchor: "message-#{room.messages.last.id}" ), style: "background-color: #433520; padding: 8px 55px; margin-left: 40px; box-shadow: 3px 4px 5px 0px rgb(0 0 0 / 38%); border-radius: 16px; color: #fff; font-weight: 400;"%>
      <#% else %>
        <#%= link_to "Send Message", new_request_path(sender_id: current_user, recipient_id: @user), style: "background-color: #433520; padding: 8px 55px; margin-left: 40px; box-shadow: 3px 4px 5px 0px rgba(0, 0, 0, 0.38); border-radius: 16px; color: #fff; font-weight: 400;" %>
      -->
      <% end %>


    </div>
    <br>

  </div>
</div>
